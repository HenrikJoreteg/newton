<!DOCTYPE html>
<html>
<head>
  <title>Newton.js: Constraints Example</title>
  <link rel='stylesheet' type='text/css' href='../shared/style.css' />
</head>
<body>

<div class='wrap'>
  <canvas id="display" width="1280" height="450"></canvas>
</div>

<script type="text/javascript" src="../../bower_components/jquery/jquery.js"></script>
<script type='text/javascript' src='../../newton.js'></script>

<script>

  var renderer = Newton.Renderer(document.getElementById('display'));
  var sim = Newton.Simulator(simulate, renderer.callback, 60);
  var structure = buildStructure(100, 100, 100, 5);

  var mainLayer = sim.Layer();

  mainLayer
    .addBody(structure)
    .addForce(Newton.LinearGravity(0, 0.001, 0))
    .containBy(Newton.Rectangle(0, 0, 1280, 450));

  sim.start();

  function simulate(time) {

  }

  function buildStructure(x, y, segmentLength, segments) {
    var b = Newton.Body();
    var top = b.Particle(x, y);
    var bottom = b.Particle(x, y + segmentLength);

    for (var i = 0; i < segments; i++) {
      var nextTop = b.Particle(x + i * segmentLength, y);
      var nextBottom = b.Particle(x + i * segmentLength, y + segmentLength);

      top.DistanceConstraint(nextTop);
      bottom.DistanceConstraint(nextBottom);
      nextTop.DistanceConstraint(nextBottom);
      top.DistanceConstraint(nextBottom);

      top = nextTop;
      bottom = nextBottom;
    }

    return b;
  }

</script>

</body>